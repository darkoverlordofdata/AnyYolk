(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){$(function(){var CreditsScene,EggModel,EggView,Game,GameOverScene,GameScene,GameState,HighscoreScene,MenuScene,Stage;Game={initialize:function(){var model;if(Utils.isSupported()){model=new GameState;new Stage({model:model}).render();new MenuScene({model:model});new GameScene({model:model});new GameOverScene({model:model});new HighscoreScene({model:model});new CreditsScene({model:model});model.set("scene","menu");$("#stage").on("dragstart selectstart","*",function(event){return false});return document.ontouchmove=function(e){return e.preventDefault()}}else{return $("#unsupported").show()}}};GameState=Backbone.Model.extend({defaults:{scene:"",eggCollection:null,speedX:1},initialize:function(){var query;_.bindAll(this);this.set("eggCollection",new Backbone.Collection);query=new Parse.Query("HighScore");query.descending("score");query.include("player");query.limit(10);this.set("highscoreCollection",query.collection());this.resetGameData();this.get("eggCollection").on("fly",this.incrementScore);this.get("eggCollection").on("break",this.decrementLife);this.get("eggCollection").on("fly break",this.cleanUpEgg);return this.get("eggCollection").on("remove",this.incrementLevel)},incrementScore:function(){return this.set("score",this.get("score")+1)},decrementLife:function(){this.set("lives",this.get("lives")-1);return this.validateAlive()},incrementLevel:function(){if(this.get("eggCollection").length<=0){this.set("level",this.get("level")+1);this.set("speedX",this.get("speedX")+.25);return this.addEggs()}},validateAlive:function(){if(this.get("lives")<=0){return this.set("scene","game_over")}},addEggs:function(){var i,numEggs,_results;numEggs=10;i=0;_results=[];while(i<numEggs){this.get("eggCollection").add(new EggModel({collectionIndex:i}));_results.push(i++)}return _results},cleanUpEgg:function(eggModel){return this.get("eggCollection").remove(eggModel)},resetGameData:function(){return this.set(GameState.DefaultGameData)},getScoreSubmission:function(){return(this.get("level")*362<<5)+"."+(this.get("score")*672<<4)}},{DefaultGameData:{score:0,lives:3,level:1,speedX:1}});EggModel=Backbone.Model.extend({defaults:{spriteIndex:1,collectionIndex:0},initialize:function(){return _.bindAll(this)},nextSprite:function(){this.set("spriteIndex",this.get("spriteIndex")+1);if(this.isSafe()){return this.trigger("fly",[this])}},isSafe:function(){return this.get("spriteIndex")>=EggModel.NumSprites},eggHitGround:function(){if(!this.isSafe()){return this.trigger("break",[this])}}},{NumSprites:5});EggView=Backbone.View.extend({className:"egg",spriteClass:".egg_sprite_",eggTemplate:_.template($("#_egg").html()),scene:null,events:{webkitTransitionEnd:"handleTransitionEnded",mozTransitionEnd:"handleTransitionEnded",transitionend:"handleTransitionEnded"},initialize:function(){_.bindAll(this);this.scene=this.options.scene;this.gameState=this.options.gameState;this.$el.on(Utils.clickDownOrTouch(),this.nextSprite);this.model.on("change:spriteIndex",this.renderSprites);this.model.on("fly",this.renderFlying);return this.model.on("break",this.renderBreaking)},nextSprite:function(){if(!this.model.isSafe()){this.model.nextSprite();return false}},render:function(){var delay,intermission,left,self,speed,top;self=this;this.renderSprites();intermission=3.5;delay=void 0;if(this.model.get("collectionIndex")===1){delay=intermission}else{delay=(Math.random()*6+3)/this.gameState.get("speedX")+2*this.model.get("collectionIndex")+intermission}speed=100*this.gameState.get("speedX")+Math.random()*100-50;left=Math.random()*($(window).width()-100)+30;top=$("#stage").height()-220;this.$el.css(Utils.bp()+"transition-delay",delay+"s");this.$el.css(Utils.bp()+"transition-duration",$(window).height()/speed+"s");this.$el.css(Utils.bp()+"transition-property","top opacity");this.$el.css(Utils.bp()+"transition-timing-function","linear");this.$el.css("left",left+"px");this.scene.append(this.$el);return Utils.nextTick(function(){return self.$el.css("top",top+"px")})},renderSprites:function(){return this.$el.html(this.eggTemplate({spriteIndex:this.model.get("spriteIndex")}))},renderBreaking:function(){this.$el.addClass("cracked").addClass("disabled");this.$el.css(Utils.bp()+"transition-delay","0s");return this.$el.css(Utils.bp()+"transition-duration","0.2s")},renderHidding:function(){this.$el.addClass("broken");this.$el.css(Utils.bp()+"transition-delay","1s");this.$el.css(Utils.bp()+"transition-duration","0.5s");this.$el.css(Utils.bp()+"transition-property","opacity");this.$el.css(Utils.bp()+"transition-timing-function","linear");return this.$el.css("opacity",0)},renderFlying:function(){this.$el.addClass("flying");this.$el.css(Utils.bp()+"transition-delay","0s");this.$el.css(Utils.bp()+"transition-duration","1s");this.$el.css(Utils.bp()+"transition-property","top");return this.$el.css(Utils.bp()+"transition-timing-function","linear")},renderRemove:function(){return this.remove()},handleTransitionEnded:function(e){var self;self=this;if(e.originalEvent.propertyName==="opacity"){self.renderRemove()}else if(e.originalEvent.propertyName==="top"){self.model.eggHitGround()}else{if(e.originalEvent.propertyName===Utils.bp()+"transform"||"transform"){self.renderHidding()}}return false}});Stage=Backbone.View.extend({el:"#stage",tileTemplate:_.template($("#_tile_pair").html()),treeTemplate:_.template($("#_tree").html()),sunTemplate:_.template($("#_sun").html()),cloudTemplate:_.template($("#_cloud").html()),initialize:function(){return _.bindAll(this)},render:function(){this.$el.css("height",$(window).height());this.renderSun();this.renderTrees();this.renderTiles();return this.renderClouds()},renderTiles:function(){this.$(".tile").remove();return this.$el.append(this.tileTemplate())},renderSun:function(){this.$(".sun").remove();return this.$el.append(this.sunTemplate())},renderTrees:function(){var i,left,numTrees,_results;numTrees=Math.ceil($(window).width()/200);this.$(".tree").remove();if(numTrees<=2){this.$el.append(this.treeTemplate({treeNum:3,leftValue:-100}));return this.$el.append(this.treeTemplate({treeNum:1,leftValue:120}))}else{i=0;_results=[];while(i<numTrees){left=Math.random()*200+i*200;this.$el.append(this.treeTemplate({treeNum:-1,leftValue:left-300}));_results.push(i++)}return _results}},renderClouds:function(){var delay,dir,i,numClouds,speed,top,_results;numClouds=Math.ceil($(window).width()/200);numClouds=numClouds<2?2:numClouds;i=0;_results=[];while(i<numClouds){top=Math.random()*50;delay=Math.random()*8-4+10*i;speed=20;dir=Math.floor(Math.random()*2)<1?"left":"right";this.$el.append(this.cloudTemplate({delay:delay,direction:dir,duration:$(window).width()/speed,topValue:top}));_results.push(i++)}return _results}});MenuScene=Backbone.View.extend({className:"menu_scene",events:{"animationend .title":"cleanUp","webkitAnimationEnd .title":"cleanUp","mozAnimationEnd .title":"cleanUp"},template:_.template($("#_menu").html()),sceneName:"menu",initialize:function(){_.bindAll(this);this.model.on("change:scene",this.renderSceneChange);this.$el.on(Utils.clickUpOrTouch(),"#play_button",this.handlePlayButton);this.$el.on(Utils.clickUpOrTouch(),"#highscore_button",this.handleHighscoreButton);this.$el.on(Utils.clickUpOrTouch(),"#credits_button",this.handleCreditsButton);return this},handlePlayButton:function(e){this.$(".menu_item").addClass("disabled");this.model.set("scene","game");return false},handleHighscoreButton:function(e){this.$(".menu_item").addClass("disabled");this.model.set("scene","highscore");return false},handleCreditsButton:function(e){this.$(".menu_item").addClass("disabled");this.model.set("scene","credits");return false},renderSceneChange:function(model,scene){if(model.previous("scene")===this.sceneName){this.renderRemoveScene()}else{if(scene===this.sceneName){this.render()}}return this},render:function(){this.$el.html(this.template());$("#stage").append(this.$el);return this},renderRemoveScene:function(){this.$(".title").removeClass("display").addClass("removal");this.$(".menu_item").addClass("removal");this.$(".title").css(Utils.bp()+"animation-name","raiseTitle");this.$(".menu_item").css(Utils.bp()+"animation-name","raiseMenu");return this},cleanUp:function(e){if(this.model.get("scene")!==this.sceneName&&$(e.target).hasClass("title")){this.$el.empty()}return false}});GameScene=Backbone.View.extend({className:"game_scene",events:{animationend:"cleanUp",webkitAnimationEnd:"cleanUp",mozAnimationEnd:"cleanUp"},scoreTemplate:_.template($("#_game_score").html()),levelTemplate:_.template($("#_game_level").html()),livesTemplate:_.template($("#_game_lives").html()),sceneName:"game",initialize:function(){_.bindAll(this);this.eggViews=[];this.$el.on(Utils.clickUpOrTouch(),".back_button",this.handleBackButton);this.model.on("change:scene",this.renderSceneChange);this.model.get("eggCollection").on("add",this.renderAddEgg);this.model.on("change:score",this.renderScore);this.model.on("change:lives",this.renderLives);this.model.on("change:level",this.renderLevel);return this.model.on("change:level",this.renderLevelLabel)},handleBackButton:function(e){this.$(".back_button").addClass("disabled");return this.model.set("scene","menu")},renderSceneChange:function(model,scene){if(model.previous("scene")===this.sceneName){this.renderRemoveScene()}else{if(scene===this.sceneName){this.render()}}return this},render:function(){var self;self=this;this.model.resetGameData();this.$("#hud").remove();this.$el.append("<div id='hud'></div>");this.renderLevel();setTimeout(function(){return self.renderLevelLabel()},1200);this.renderScore();this.renderLives();this.renderBackButton();this.renderEggs();if($("#stage ."+this.className).length<=0){$("#stage").append(this.$el)}return this},renderLevel:function(){if(this.$("#game_level").length>0){this.$("#game_level").replaceWith(this.levelTemplate({level:this.model.get("level")}))}else{this.$("#hud").append(this.levelTemplate({level:this.model.get("level")}))}return this},renderLevelLabel:function(){this.$el.append("<p class='level_label'>LEVEL "+this.model.get("level")+"<br>GET READY!</p>");setTimeout(function(){return this.$(".level_label").addClass("removal")},3e3);setTimeout(function(){return this.$(".level_label").remove()},3300);return this},renderScore:function(){if(this.$("#game_score").length>0){this.$("#game_score").replaceWith(this.scoreTemplate({score:this.model.get("score")}))}else{this.$("#hud").append(this.scoreTemplate({score:this.model.get("score")}))}return this},renderLives:function(){if(this.$("#game_lives").length>0){this.$("#game_lives").replaceWith(this.livesTemplate({lives:this.model.get("lives")}))}else{this.$("#hud").append(this.livesTemplate({lives:this.model.get("lives")}))}return this},renderBackButton:function(){if(this.$(".back_button").length>0){this.$(".back_button").replaceWith("<div class='back_button'>X</div>")}else{this.$el.append("<div class='back_button'>X</div>")}return this},renderEggs:function(){this.model.addEggs();return this},renderAddEgg:function(eggModel,collection,options){var eggView;eggView=new EggView({model:eggModel,gameState:this.model,scene:this.$el});eggView.render();this.eggViews.push(eggView);return this},renderRemoveScene:function(){this.$(".back_button").css(Utils.bp()+"animation-name","xRaise");this.$("#hud p").css(Utils.bp()+"animation-name","removeHUD");this.$(".egg").css(Utils.bp()+"transition-duration","0.3s");_.each(this.eggViews,function(eggView){return eggView.renderRemove()});this.model.get("eggCollection").reset();return this},cleanUp:function(e){if(this.model.get("scene")!==this.sceneName&&$(e.target).hasClass("back_button")){this.$el.empty()}return false}});GameOverScene=Backbone.View.extend({className:"game_over_scene",events:{animationend:"cleanUp",webkitAnimationEnd:"cleanUp",mozAnimationEnd:"cleanUp"},template:_.template($("#_game_over").html()),sceneName:"game_over",submitted:false,initialize:function(){_.bindAll(this);this.model.on("change:scene",this.renderSceneChange);this.$el.on(Utils.clickUpOrTouch(),".menu_button",this.handleMenuButton);this.$el.on(Utils.clickUpOrTouch(),".replay_button",this.handleReplayButton);return this.$el.on(Utils.clickUpOrTouch(),".facebook_button",this.handleFacebookButton)},handleMenuButton:function(e){this.$(".menu_item").addClass("disabled");return this.model.set("scene","menu")},handleReplayButton:function(e){this.$(".menu_item").addClass("disabled");return this.model.set("scene","game")},handleFacebookButton:function(e){var self;self=this;$(".fb_content").hide();$(".facebook_button").addClass("disabled").empty().spin({length:5,radius:5,lines:8,width:3,color:"#fff"});if(Parse.User.current()){return this.saveHighScore()}else{return Parse.FacebookUtils.logIn(null,{success:function(user){if(!user.existed()){return FB.api("/me",function(response){if(!response.error){user.set("displayName",response.name);return user.save(null,{success:function(user){return self.saveHighScore()},error:function(user,error){return console.log("Oops, something went wrong saving your name.")}})}else{return console.log("Oops something went wrong with facebook.")}})}else{return self.saveHighScore()}},error:function(user,error){return console.log("Oops, something went wrong.")}})}},saveHighScore:function(){var self,submission;self=this;submission={score:this.model.getScoreSubmission()};return Parse.Cloud.run("submitHighscore",submission,{success:function(result){self.submitted=true;return self.$(".facebook_button").html("Submitted!")},error:function(error){self.submitted=true;return self.$(".facebook_button").html(" X Try Again...").removeClass("disabled")}})},renderSceneChange:function(model,scene){if(model.previous("scene")===this.sceneName){this.renderRemoveScene()}else{if(scene===this.sceneName){this.render()}}return this},render:function(){var congratsIndex;congratsIndex=this.model.get("level")>GameOverScene.Congrats.length?GameOverScene.Congrats.length-1:this.model.get("level")-1;this.$el.html(this.template({score:this.model.get("score"),congrats:GameOverScene.Congrats[congratsIndex]}));return $("#stage").append(this.$el)},renderRemoveScene:function(){this.$(".menu_item").addClass("removal");this.$(".summary").addClass("removal");this.$(".menu_item").css(Utils.bp()+"animation-name","raiseMenu");return this.$(".summary").css(Utils.bp()+"animation-name","raiseScores")},cleanUp:function(e){if(this.model.get("scene")!==this.sceneName&&$(e.target).hasClass("summary")){return this.$el.empty()}}},{Congrats:["Not bad","Good","Great","Fantastic","Smashing!","Amazing!","Flying High","Ridiculous!","Extraordinary!","Monstrous!!"]});HighscoreScene=Backbone.View.extend({className:"highscore_scene",events:{animationend:"cleanUp",webkitAnimationEnd:"cleanUp",mozAnimationEnd:"cleanUp"},template:_.template($("#_highscore").html()),scoreTemplate:_.template($("#_score").html()),sceneName:"highscore",initialize:function(){_.bindAll(this);this.model.on("change:scene",this.renderSceneChange);this.model.get("highscoreCollection").on("reset",this.renderScoreCollection);this.$el.on(Utils.clickUpOrTouch(),".back_button",this.handleBackButton);if(this.model.get("currentScene")===this.sceneName){return this.render()}},handleBackButton:function(e){this.$(".back_button").addClass("disabled");this.model.set("scene","menu");return false},renderSceneChange:function(model,scene){if(model.previous("scene")===this.sceneName){this.renderRemoveScene()}else{if(scene===this.sceneName){this.render()}}return this},render:function(){var self;self=this;this.$el.html(this.template());this.model.get("highscoreCollection").fetch();this.$(".highscore").spin({length:9,radius:10,lines:12,width:4,color:"#fff"});$("#stage").append(this.$el);return this},renderScoreCollection:function(){var self;self=this;this.model.get("highscoreCollection").each(function(score,index){return self.renderScore(score,index)});$(".highscore .spinner").remove();return this},renderScore:function(score,index){return this.$("#score_table tbody").append(this.scoreTemplate({score:score,index:index}))},renderRemoveScene:function(){this.$(".menu_item").addClass("removal");this.$(".highscore").addClass("removal");this.$(".menu_item").css(Utils.bp()+"animation-name","raiseMenu");return this.$(".highscore").css(Utils.bp()+"animation-name","raiseScores")},cleanUp:function(e){if(this.model.get("scene")!==this.sceneName&&$(e.target).hasClass("highscore")){return this.$el.empty()}}});CreditsScene=Backbone.View.extend({className:"credits_scene",template:_.template($("#_credits").html()),sceneName:"credits",events:{animationend:"cleanUp",webkitAnimationEnd:"cleanUp",mozAnimationEnd:"cleanUp"},initialize:function(){_.bindAll(this);this.model.on("change:scene",this.renderSceneChange);return this.$el.on(Utils.clickUpOrTouch(),".back_button",this.handleBackButton)},handleBackButton:function(e){this.$(".back_button").addClass("disabled");this.model.set("scene","menu");return false},renderSceneChange:function(model,scene){if(model.previous("scene")===this.sceneName){this.renderRemoveScene()}else{if(scene===this.sceneName){this.render()}}return this},render:function(){var self;self=this;this.$el.html(this.template());$("#stage").append(this.$el);return this},renderRemoveScene:function(){this.$(".credits").addClass("removal");this.$(".back_button").addClass("removal");this.$(".credits").css(Utils.bp()+"animation-name","raiseMenu");return this.$(".back_button").css(Utils.bp()+"animation-name","raiseMenu")},cleanUp:function(e){if(this.model.get("scene")!==this.sceneName&&$(e.target).hasClass("credits")){return this.$el.empty()}}});return Game.initialize()});window.Utils={bp:function(){var bp;bp="";if($.browser.webkit){bp="-webkit-"}else{if($.browser.mozilla){bp="-moz-"}}return bp},isSupported:function(){return!($.browser.msie&&parseInt($.browser.version)<10)},nextTick:function(func){return setTimeout(func,0)},clickUpOrTouch:function(func){if("ontouchstart"in window){return"touchstart"}else{return"mouseup"}},clickDownOrTouch:function(func){if("ontouchstart"in window){return"touchstart"}else{return"mousedown"}}};$.fn.spin=function(opts){this.each(function(){var $this,data;$this=$(this);data=$this.data();if(data.spinner){data.spinner.stop();delete data.spinner}if(opts!==false){return data.spinner=new Spinner($.extend({color:$this.css("color")},opts)).spin(this)}});return this};Parse.initialize("0ZUn1TaDF9G3j6UhvoNFuIVSzF45vpSO9K0rlosM","oU1ToZ9LNZoMslphpgxQNoVjJXEqoi59M018ZP08");window.fbAsyncInit=function(){return Parse.FacebookUtils.init({appId:"1380103182250520",channelUrl:"/channel.html",status:true,cookie:true,xfbml:true})};(function(d,debug){var id,js,ref;js=void 0;id="facebook-jssdk";ref=d.getElementsByTagName("script")[0];if(d.getElementById(id)){return}js=d.createElement("script");js.id=id;js.async=true;js.src="//connect.facebook.net/en_US/all"+(debug?"/debug":"")+".js";return ref.parentNode.insertBefore(js,ref)})(document,false)},{}]},{},[1]);